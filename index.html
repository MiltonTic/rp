<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Cadastro de Dados</title>
</head>
<body>
  <h2>Cadastro</h2>
  <form id="dataForm">
    Código: <input type="text" id="cod" maxlength="8" required><br><br>
    Observação: <input type="text" id="obs"><br><br>
    <button type="submit">Enviar</button>
  </form>

  <script>
    const form = document.getElementById("dataForm");
    form.addEventListener("submit", function(e) {
      e.preventDefault();

      // Pega localização
      navigator.geolocation.getCurrentPosition(function(position) {
        const data = {
          cod: document.getElementById("cod").value,
          gps: position.coords.latitude + "," + position.coords.longitude,
          obs: document.getElementById("obs").value
        };

        // Envia para o Apps Script usando google.script.run
        google.script.run.withSuccessHandler(function(resp) {
          alert("Enviado com sucesso: " + resp);
          form.reset();
        }).withFailureHandler(function(err) {
          alert("Erro ao enviar: " + err.message);
        }).salvarDados(data);

      }, function(error) {
        alert("Erro ao obter localização: " + error.message);
      });
    });
  </script>
</body>
</html>
